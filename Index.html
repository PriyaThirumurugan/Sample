<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lost & Found ‚Ä¢ Campus</title>

  <!-- Modern readable font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #f7fbff;
      --card: #ffffff;
      --accent: linear-gradient(135deg,#66a6ff 0%,#89f7fe 100%);
      --primary:#3b82f6;
      --muted:#6b7280;
      --success:#10b981;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.6);
      --radius:14px;
      --shadow: 0 6px 18px rgba(29,41,89,0.07);
    }

    * { box-sizing: border-box; }
    html,body { height:100%; }
    body{
      margin:0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(137,247,254,0.12), transparent),
                  radial-gradient(900px 400px at 90% 90%, rgba(102,166,255,0.08), transparent),
                  var(--bg);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:20px;
      display:flex;
      flex-direction:column;
      gap:20px;
      align-items:stretch;
      min-height:100vh;
    }

    header.app-header{
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:6px;
    }
    .brand{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo{
      width:58px;height:58px;border-radius:12px;
      background:var(--accent);
      display:flex;align-items:center;justify-content:center;
      font-weight:700;color:white;font-size:20px;box-shadow:var(--shadow);
    }
    .title{
      display:flex;flex-direction:column;
    }
    .title h1{ margin:0;font-size:20px;letter-spacing:0.2px;}
    .title p{ margin:0;font-size:12px;color:var(--muted); }

    .controls{
      display:flex;
      gap:8px;
      align-items:center;
    }

    .btn{
      background:linear-gradient(135deg,#5b8cff,#2fb6ff);
      color:white;padding:10px 14px;border-radius:12px;border:none;cursor:pointer;font-weight:600;
      display:inline-flex;gap:8px;align-items:center;box-shadow:var(--shadow);
    }
    .btn.ghost{
      background:transparent;color:var(--primary);border:1px solid rgba(59,130,246,0.12);
    }
    .btn:active{ transform:translateY(1px); }

    /* search / filter row */
    .row{
      display:flex;gap:12px;flex-wrap:wrap;align-items:center;
    }
    .search{
      flex:1;min-width:180px;display:flex;gap:8px;align-items:center;
      background:var(--card);padding:10px;border-radius:12px;box-shadow:var(--shadow);
    }
    .search input{
      border:0;outline:none;font-size:14px;background:transparent;width:100%;
    }
    select, input[type=date]{ padding:8px;border-radius:10px;border:1px solid #e6eefb;background:white; }

    /* grid */
    main{
      flex:1;
      display:grid;
      grid-template-columns: 1fr;
      gap:18px;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fill,minmax(260px,1fr));
      gap:16px;
      align-items:start;
    }

    .card{
      background:var(--card);
      border-radius:14px;padding:12px;box-shadow:var(--shadow);
      display:flex;flex-direction:column;gap:10px;
    }
    .card .imgwrap{
      width:100%;height:160px;border-radius:10px;overflow:hidden;background:#f2f8ff;display:flex;align-items:center;justify-content:center;
    }
    .card img{ width:100%;height:100%;object-fit:cover; }
    .badge{
      display:inline-block;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;color:white;
    }
    .badge.lost{ background:linear-gradient(90deg,#ff6b6b,#ff8a8a); }
    .badge.found{ background:linear-gradient(90deg,#34d399,#60caa6); }

    .meta{ display:flex;justify-content:space-between;align-items:center;gap:8px;font-size:13px;color:var(--muted);flex-wrap:wrap; }
    .desc{ font-size:14px;color:#0f172a;line-height:1.35;min-height:42px; }

    .actions{ display:flex;gap:8px; }
    .small{ padding:8px 10px;border-radius:10px;border:0;cursor:pointer;background:#f1f5f9;font-weight:600; }

    /* empty state */
    .empty{
      text-align:center;padding:30px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.6));box-shadow:var(--shadow);
      color:var(--muted);
    }

    /* modal form */
    .modal{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(2,6,23,0.3),rgba(2,6,23,0.35));
      z-index:60;padding:20px;
    }
    .modal.show{ display:flex; }
    .panel{
      width:100%;max-width:920px;background:var(--card);border-radius:16px;padding:18px;box-shadow:0 20px 50px rgba(2,6,23,0.2);
    }
    .panel h3{ margin:0 0 6px 0; }
    form.grid-2{ display:grid;grid-template-columns:1fr 1fr;gap:12px; }
    label{ display:block;font-size:13px;color:var(--muted);margin-bottom:6px; }
    input[type="text"], input[type="tel"], textarea, select, input[type="date"]{
      width:100%;padding:10px;border-radius:10px;border:1px solid #e6eefb;font-size:14px;
    }
    textarea{ min-height:100px; resize:vertical; }

    .filebox{
      display:flex;gap:12px;align-items:center;
    }
    .preview{ width:120px;height:80px;border-radius:8px;overflow:hidden;background:#f2f8ff;display:flex;align-items:center;justify-content:center;border:1px dashed #e6eefb; }
    .preview img{ width:100%;height:100%;object-fit:cover; }

    /* toast */
    .toast{
      position:fixed;right:18px;bottom:18px;background:#111827;color:white;padding:12px 16px;border-radius:12px;box-shadow:var(--shadow);display:none;z-index:90;
    }
    .toast.show{ display:block; animation:pop .28s ease; }
    @keyframes pop{ from{ transform:translateY(8px); opacity:0 } to{ transform:none; opacity:1 } }

    /* responsive */
    @media (max-width:820px){
      form.grid-2{ grid-template-columns:1fr; }
      .panel{ padding:14px; }
      .imgwrap{ height:140px; }
    }

    footer{ text-align:center;color:var(--muted); font-size:13px; margin-top:8px; }
    .muted{ color:var(--muted); font-size:13px; }
  </style>
</head>
<body>

  <header class="app-header" role="banner">
    <div class="brand" aria-hidden="false">
      <div class="logo" aria-hidden="true">LF</div>
      <div class="title">
        <h1>Lost & Found ‚Ä¢ Campus</h1>
        <p>Find lost items ‚Ä¢ Report found ‚Ä¢ Help your classmates üßë‚Äçüéì</p>
      </div>
    </div>

    <div class="controls" role="navigation" aria-label="Primary actions">
      <div class="row">
        <div class="search" title="Search items">
          <svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18" fill="#6b7280" style="opacity:0.9"><path d="M0 0h24v24H0z" fill="none"/><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5C16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5z"/></svg>
          <input id="q" type="search" placeholder="Search by name, desc, location, phone...">
        </div>

        <select id="filterType" title="Filter by type">
          <option value="all">All Types</option>
          <option value="Lost">Lost ‚ùå</option>
          <option value="Found">Found ‚úÖ</option>
        </select>

        <select id="sortBy" title="Sort">
          <option value="new">Newest</option>
          <option value="old">Oldest</option>
        </select>

        <button class="btn" id="openReport"><span>‚ûï</span> Report</button>
      </div>
    </div>
  </header>

  <main role="main">
    <section id="board" class="grid" aria-live="polite">
      <!-- item cards rendered here -->
    </section>

    <div id="emptyState" class="empty" style="display:none;">
      <h3>Nothing here yet ‚ú®</h3>
      <p class="muted">No items reported. Click <strong>Report</strong> to add a lost or found item.</p>
    </div>
  </main>

  <footer>
    <span class="muted">Data saved locally in your browser ‚Ä¢ Images stored as base64 ‚Ä¢ Mobile responsive ‚úÖ</span>
  </footer>

  <!-- Modal / Report form -->
  <div class="modal" id="modal">
    <div class="panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <div>
          <h3 id="modalTitle">üìù Report Lost / Found Item</h3>
          <p class="muted" style="margin:2px 0 0;">Fill the form to help others recover items quickly.</p>
        </div>
        <button class="btn ghost" id="closeModal">Close ‚úñ</button>
      </div>

      <form id="reportForm" class="grid-2" novalidate>
        <div>
          <label for="type">Type</label>
          <select id="type" required>
            <option value="">-- Select --</option>
            <option value="Lost">Lost ‚ùå</option>
            <option value="Found">Found ‚úÖ</option>
          </select>
        </div>

        <div>
          <label for="date">Date of loss/found</label>
          <input id="date" type="date" required>
        </div>

        <div>
          <label for="itemName">Item name</label>
          <input id="itemName" type="text" placeholder="e.g., Black Notebook, ID card" maxlength="80" required>
        </div>

        <div>
          <label for="location">Location</label>
          <input id="location" type="text" placeholder="e.g., Library, Canteen, Block A" maxlength="80" required>
        </div>

        <div style="grid-column: 1 / -1;">
          <label for="description">Item description</label>
          <textarea id="description" placeholder="Provide details (brand, color, unique marks)..." maxlength="600" required></textarea>
        </div>

        <div>
          <label for="phone">Contact phone number</label>
          <input id="phone" type="tel" placeholder="+91 98765 43210" required>
        </div>

        <div>
          <label for="photo">Photo (optional but helpful)</label>
          <div class="filebox">
            <input id="photo" type="file" accept="image/*" />
            <div class="preview" id="preview">üì∑</div>
          </div>
        </div>

        <div style="grid-column: 1 / -1; display:flex; gap:8px; justify-content:flex-end; margin-top:6px;">
          <button type="button" class="btn ghost" id="resetForm">Reset</button>
          <button type="submit" class="btn" id="submitBtn">Submit Report</button>
        </div>
      </form>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
  /* ========== Lost & Found SPA (Modular) ========== */
  (function(){
    const LS_KEY = 'lf_items_v1';
    let items = [];

    // DOM
    const board = document.getElementById('board');
    const emptyState = document.getElementById('emptyState');
    const q = document.getElementById('q');
    const filterType = document.getElementById('filterType');
    const sortBy = document.getElementById('sortBy');
    const openReport = document.getElementById('openReport');
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const reportForm = document.getElementById('reportForm');
    const preview = document.getElementById('preview');
    const photoInput = document.getElementById('photo');
    const toast = document.getElementById('toast');
    const resetFormBtn = document.getElementById('resetForm');

    // form fields
    const fld = {
      type: document.getElementById('type'),
      date: document.getElementById('date'),
      itemName: document.getElementById('itemName'),
      location: document.getElementById('location'),
      description: document.getElementById('description'),
      phone: document.getElementById('phone'),
      photo: photoInput
    };

    // load from localStorage
    function load(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        items = raw ? JSON.parse(raw) : [];
      }catch(e){
        console.error('Failed parsing localStorage', e);
        items = [];
      }
    }

    function save(){
      try{
        localStorage.setItem(LS_KEY, JSON.stringify(items));
      }catch(e){
        showToast('Could not save data. Check storage permissions.', true);
      }
    }

    // toast helper
    let toastTimer = null;
    function showToast(msg, isError=false){
      toast.textContent = msg;
      toast.style.background = isError ? 'linear-gradient(90deg,#ef4444,#f97316)' : '#0b1220';
      toast.classList.add('show');
      if(toastTimer) clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toast.classList.remove('show'), 3000);
    }

    // create DOM card for item
    function createCard(item, idx){
      const card = document.createElement('article');
      card.className = 'card';
      card.setAttribute('data-id', item.id);

      // image
      const imgwrap = document.createElement('div');
      imgwrap.className = 'imgwrap';
      if(item.image){
        const img = document.createElement('img');
        img.src = item.image;
        img.alt = item.name;
        imgwrap.appendChild(img);
      } else {
        imgwrap.innerHTML = '<div style="text-align:center;color:var(--muted)">'+ (item.type === 'Lost' ? 'Lost Item' : 'Found Item') +'<br>üì∑ No photo</div>';
      }

      // header: badge + name
      const header = document.createElement('div');
      header.style.display = 'flex';
      header.style.justifyContent = 'space-between';
      header.style.alignItems = 'center';
      const badge = document.createElement('div');
      badge.className = 'badge ' + (item.type === 'Lost' ? 'lost' : 'found');
      badge.textContent = item.type;
      const title = document.createElement('div');
      title.innerHTML = `<strong>${escapeHtml(item.name)}</strong>`;
      header.appendChild(badge);
      header.appendChild(title);

      const desc = document.createElement('p');
      desc.className = 'desc';
      desc.textContent = item.description;

      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.innerHTML = `<div>üìç ${escapeHtml(item.location)}</div><div>üìÖ ${escapeHtml(item.date)}</div>`;

      const contact = document.createElement('div');
      contact.className = 'muted';
      contact.innerHTML = `üë§ ${escapeHtml(item.reporter)} ‚Ä¢ üìû ${escapeHtml(item.phone)}`;

      const actions = document.createElement('div');
      actions.className = 'actions';
      const claimBtn = document.createElement('button');
      claimBtn.className = 'small';
      claimBtn.textContent = item.claimed ? '‚úÖ Claimed' : 'Claim';
      claimBtn.disabled = item.claimed;
      claimBtn.addEventListener('click', ()=> markClaimed(item.id));
      const delBtn = document.createElement('button');
      delBtn.className = 'small';
      delBtn.textContent = 'Delete';
      delBtn.style.color = '#b91c1c';
      delBtn.addEventListener('click', ()=> deleteItem(item.id));

      actions.appendChild(claimBtn);
      actions.appendChild(delBtn);

      card.appendChild(imgwrap);
      card.appendChild(header);
      card.appendChild(desc);
      card.appendChild(meta);
      card.appendChild(contact);
      card.appendChild(actions);

      return card;
    }

    function render(filterText = '', typeFilter='all', sort='new'){
      board.innerHTML = '';
      let list = items.slice();

      // filter type
      if(typeFilter !== 'all') list = list.filter(i => i.type === typeFilter);

      // search filter
      if(filterText){
        const s = filterText.toLowerCase();
        list = list.filter(i => 
          (i.name && i.name.toLowerCase().includes(s)) ||
          (i.description && i.description.toLowerCase().includes(s)) ||
          (i.location && i.location.toLowerCase().includes(s)) ||
          (i.phone && i.phone.toLowerCase().includes(s)) ||
          (i.reporter && i.reporter.toLowerCase().includes(s))
        );
      }

      // sort
      list.sort((a,b)=>{
        const da = new Date(a.createdAt), db = new Date(b.createdAt);
        return sort === 'new' ? db - da : da - db;
      });

      if(list.length === 0){
        emptyState.style.display = 'block';
      } else {
        emptyState.style.display = 'none';
        list.forEach((it, idx) => board.appendChild(createCard(it, idx)));
      }
    }

    // helper: escape HTML to prevent injection inside text nodes
    function escapeHtml(s=''){
      return String(s).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
    }

    // create item ID
    function id(){
      return 'it_' + Date.now() + '_' + Math.floor(Math.random()*9999);
    }

    // mark claimed
    function markClaimed(idVal){
      const idx = items.findIndex(i=>i.id===idVal);
      if(idx === -1) return;
      items[idx].claimed = true;
      save();
      render(q.value, filterType.value, sortBy.value);
      showToast('Marked as claimed ‚úÖ');
    }

    // delete item with confirmation
    function deleteItem(idVal){
      if(!confirm('Delete this entry? This cannot be undone.')) return;
      items = items.filter(i=>i.id !== idVal);
      save();
      render(q.value, filterType.value, sortBy.value);
      showToast('Deleted item üóëÔ∏è');
    }

    // handle file -> base64 preview
    function readImage(file, cb){
      if(!file) return cb(null);
      const allowed = ['image/png','image/jpeg','image/jpg','image/webp'];
      if(!allowed.includes(file.type)){
        cb(new Error('Unsupported image type'));
        return;
      }
      const reader = new FileReader();
      reader.onload = () => cb(null, reader.result);
      reader.onerror = () => cb(new Error('Could not read file'));
      reader.readAsDataURL(file);
    }

    // validation
    function validateForm(data){
      const errors = [];
      if(!data.type) errors.push('Select Lost or Found.');
      if(!data.date) errors.push('Provide the date of lost/found.');
      if(!data.name || data.name.trim().length < 2) errors.push('Provide an item name (2+ chars).');
      if(!data.location || data.location.trim().length < 2) errors.push('Provide location (2+ chars).');
      if(!data.description || data.description.trim().length < 6) errors.push('Provide a short description (6+ chars).');
      // basic phone check (international-ish, digits and +, min 7)
      const phoneVal = (data.phone||'').replace(/\s+/g,'');
      if(!/^[+0-9\-\(\) ]{7,20}$/.test(phoneVal)) errors.push('Provide a valid phone number.');
      return errors;
    }

    // form submit handler
    reportForm.addEventListener('submit', function(e){
      e.preventDefault();
      const fdata = {
        type: fld.type.value,
        date: fld.date.value,
        name: fld.itemName.value.trim(),
        location: fld.location.value.trim(),
        description: fld.description.value.trim(),
        reporter: 'Anonymous',
        phone: fld.phone.value.trim(),
        image: null,
        createdAt: new Date().toISOString(),
        claimed: false
      };

      // get phone and optional reporter (we didn't include reporter field in UI to keep minimal; set to phone owner)
      // Use reporter=phone owner name if phone includes name? For simplicity keep reporter as phone owner placeholder
      fdata.reporter = 'Reporter';

      const errors = validateForm(fdata);
      if(errors.length){
        showToast(errors[0], true);
        return;
      }

      const file = fld.photo.files && fld.photo.files[0];
      if(file){
        readImage(file, function(err, dataUrl){
          if(err){
            showToast(err.message, true);
            return;
          }
          fdata.image = dataUrl;
          pushItemAndClose(fdata);
        });
      } else {
        pushItemAndClose(fdata);
      }
    });

    function pushItemAndClose(fdata){
      const newItem = {
        id: id(),
        type: fdata.type,
        date: fdata.date,
        name: fdata.name,
        location: fdata.location,
        description: fdata.description,
        phone: fdata.phone,
        reporter: fdata.reporter,
        image: fdata.image,
        createdAt: fdata.createdAt,
        claimed: false
      };
      items.push(newItem);
      save();
      showToast('Reported successfully üéâ');
      closeModalFunc();
      render(q.value, filterType.value, sortBy.value);
      reportForm.reset();
      preview.innerHTML = 'üì∑';
    }

    // open modal
    openReport.addEventListener('click', ()=> {
      modal.classList.add('show');
      // default date to today
      fld.date.value = new Date().toISOString().slice(0,10);
    });
    closeModal.addEventListener('click', closeModalFunc);
    function closeModalFunc(){
      modal.classList.remove('show');
    }

    // preview when file chosen
    photoInput.addEventListener('change', function(){
      const file = this.files && this.files[0];
      if(!file){ preview.innerHTML = 'üì∑'; return; }
      readImage(file, function(err, dataUrl){
        if(err){ showToast(err.message, true); preview.innerHTML = 'üì∑'; return; }
        preview.innerHTML = '<img alt="preview" src="'+dataUrl+'">';
      });
    });

    // search/filter events
    q.addEventListener('input', ()=> render(q.value, filterType.value, sortBy.value));
    filterType.addEventListener('change', ()=> render(q.value, filterType.value, sortBy.value));
    sortBy.addEventListener('change', ()=> render(q.value, filterType.value, sortBy.value));

    // reset form
    resetFormBtn.addEventListener('click', ()=>{
      reportForm.reset();
      preview.innerHTML = 'üì∑';
      fld.date.value = new Date().toISOString().slice(0,10);
    });

    // initial load
    load();
    render();

    // add keyboard shortcut: N to open form (helpful)
    document.addEventListener('keydown', (e)=>{
      if(e.key.toLowerCase() === 'n' && !modal.classList.contains('show')) {
        openReport.click();
      }
      if(e.key === 'Escape' && modal.classList.contains('show')) {
        closeModalFunc();
      }
    });

    // small helper: clear example data on long-press (development)
    // for safety: not exposed

  })();
  </script>
</body>
  </html>
